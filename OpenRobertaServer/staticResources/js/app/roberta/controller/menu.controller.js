define(["require","exports","message","comm","wrap","robot.controller","socket.controller","user.controller","notification.controller","guiState.controller","program.controller","progRun.controller","configuration.controller","import.controller","tour.controller","sourceCodeEditor.controller","jquery","blockly","progTutorial.controller","util.roberta","slick"],(function(e,o,t,a,n,r,i,l,c,s,d,u,p,g,h,m,b,f,k,w){Object.defineProperty(o,"__esModule",{value:!0}),o.init=void 0;var v,P=0,S="?",y="&",W="=",C="forgotPassword",L="activateAccount",R="loadSystem",O="tutorial",T="gallery",M="tour",A="kiosk",_="exampleView",B="loadProgram";function x(e){var o,t=decodeURIComponent(document.location.toString()),a=t.indexOf("?"),n=t=t.substring(a+1),r=n.indexOf("<");r>=0&&(n=t.substring(0,r),o=t.substring(r));var i,l,c=n.split(y);for(l=0;l<c.length;l++)if((i=c[l].split(W))[0]===e)return void 0===i[1]||("loadProgram"===i[0]?o:i[1])}function E(){b(".fromRight.rightActive").length>0?b("#blocklyDiv").closeRightView((function(){return w.closeSimRobotWindow(),b("#tabStart").tabWrapShow()})):b("#tabStart").tabWrapShow()}o.init=function(e){e&&e instanceof Function?(v=e,b("#startupVersion").text(s.getServerVersion()),function(){b(".navbar-collapse a:not(.dropdown-toggle)").click((function(){b(".dropdown-menu.show").collapse("hide"),b(".navbar-collapse.show").collapse("hide")})),navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)||(b('[rel="tooltip"]').not(".rightMenuButton").tooltip({container:"body",placement:"right",trigger:"hover"}),b('[rel="tooltip"].rightMenuButton').tooltip({container:"body",placement:"left",trigger:"hover"}));if(document.addEventListener("gesturestart",(function(e){e.preventDefault(),e.stopPropagation()})),b(".blocklyButtonBack, .blocklyWidgetDiv, #head-navigation, #main-section, #tutorial-navigation").on("mousedown touchstart keydown",(function(e){if(b(e.target).not(".blocklyTreeLabel, .blocklytreerow, .toolboxicon, .goog-palette-colorswatch, .goog-menu-vertical, .goog-menuitem-checkbox, div.goog-menuitem-content, div.goog-menuitem, img").length>0){if(b(e.target).filter(".blocklyHtmlInput").length>0&&!e.metaKey)return;f&&f.getMainWorkspace()&&f.hideChaff()}})),b(".modal").onWrap("shown.bs.modal",(function(){b(this).find("[autofocus]").focus()})),b(".navbar-collapse").on("click",".dropdown-menu a,.visible-xs",(function(e){b("#navbarCollapse").collapse("hide")})),b("#head-navigation-gallery").on("click","a,.visible-xs",(function(e){b("#navbarCollapse").collapse("hide")})),s.isPublicServerVersion()){var e='<div href="#" id="feedbackButton" class="rightMenuButton" rel="tooltip" data-bs-original-title="" title=""><span id="" class="feedbackButton typcn typcn-feedback"></span></div>';b("#rightMenuDiv").append(e),window.onmessage=function(e){if("closeFeedback"===e.data)b("#feedbackIframe").oneWrap("load",(function(){setTimeout((function(){b("#feedbackIframe").attr("src","about:blank"),b("#feedbackModal").modal("hide")}),1e3)}));else if(e.data.indexOf("feedbackHeight")>=0){var o=e.data.split(":")[1]||400;b("#feedbackIframe").height(o)}},b("#feedbackButton").on("click","",(function(e){b("#feedbackModal").on("show.bs.modal",(function(){"de"===s.getLanguage().toLowerCase()?b("#feedbackIframe").attr("src","https://www.roberta-home.de/lab/feedback/"):b("#feedbackIframe").attr("src","https://www.roberta-home.de/en/lab/feedback/")})),b("#feedbackModal").modal("show")}))}b("#head-navigation-program-edit").on("click",".dropdown-menu li:not(.disabled) a",(function(e){var o=function(e){switch(e.target.id||e.currentTarget.id){case"menuRunProg":u.runOnBrick();break;case"menuRunSim":b("#simButton").clickWrap();break;case"menuCheckProg":d.checkProgram();break;case"menuNewProg":d.newProgram();break;case"menuListProg":b("#tabProgList").data("type","Programs"),b("#tabProgList").tabWrapShow();break;case"menuListExamples":b("#tabProgList").data("type","Examples"),b("#tabProgList").tabWrapShow();break;case"menuSaveProg":d.saveToServer();break;case"menuSaveAsProg":d.showSaveAsModal();break;case"menuShowCode":b("#codeButton").clickWrap();break;case"menuSourceCodeEditor":m.clickSourceCodeEditor();break;case"menuExportProg":d.exportXml();break;case"menuExportAllProgs":d.exportAllXml();break;case"menuLinkProg":d.linkProgram();break;case"menuToolboxBeginner":b('.levelTabs a[href="#beginner"]').tabWrapShow();break;case"menuToolboxExpert":b('.levelTabs a[href="#expert"]').tabWrapShow();break;case"menuDefaultFirmware":u.reset2DefaultFirmware()}};n.wrapUI(o,"edit menu click")(e)})),b("#head-navigation-configuration-edit").onWrap("click",".dropdown-menu li:not(.disabled) a",(function(e){switch(b(".modal").modal("hide"),e.target.id){case"menuCheckConfig":t.displayMessage("MESSAGE_NOT_AVAILABLE","POPUP","");break;case"menuNewConfig":p.newConfiguration();break;case"menuListConfig":b("#tabConfList").tabWrapShow();break;case"menuSaveConfig":p.saveToServer();break;case"menuSaveAsConfig":p.showSaveAsModal()}}),"configuration edit clicked"),b("#head-navigation-robot").onWrap("click",".dropdown-menu li:not(.disabled) a",(function(e){b(".modal").modal("hide");var o=e.target.parentElement.dataset.type;if(o)r.switchRobot(o);else{var t=e.currentTarget.id;if("menuConnect"===t)if("arduinoAgent"==s.getConnection()||"arduinoAgentOrToken"==s.getConnection()&&1==s.getIsAgent()){var a=i.getPortList(),n=i.getRobotList();b("#singleModalListInput").empty();var l=0;a.forEach((function(e){b("#singleModalListInput").append('<option value="'+e+'" selected>'+n[l]+" "+e+"</option>"),l++})),r.showListModal()}else"webview"==s.getConnection()?r.showScanModal():(b("#buttonCancelFirmwareUpdate").css("display","inline"),b("#buttonCancelFirmwareUpdateAndRun").css("display","none"),r.showSetTokenModal());else"menuRobotInfo"===t?r.showRobotInfo():"menuWlan"===t?r.showWlanForm():"menuRobotSwitch"===t&&E()}}),"robot clicked"),b("#head-navigation-help").onWrap("click",".dropdown-menu li:not(.disabled) a",(function(e){b(".modal").modal("hide");var o=e.target.id;"menuShowStart"===o?E():"menuAbout"===o?(b("#version").text(s.getServerVersion()),b("#show-about").modal("show")):"menuLogging"===o&&b("#tabLogList").tabWrapShow()}),"help clicked"),b("#head-navigation-user").onWrap("click",".dropdown-menu li:not(.disabled) a",(function(e){switch(b(".modal").modal("hide"),e.target.id){case"menuUserGroupLogin":l.showUserGroupLoginForm();break;case"menuLogout":l.logout();break;case"menuGroupPanel":b("#tabUserGroupList").tabWrapShow();break;case"menuChangeUser":l.showUserDataForm();break;case"menuDeleteUser":l.showDeleteUserModal();break;case"menuStateInfo":l.showUserInfo();break;case"menuNotification":c.showNotificationModal()}return!1}),"user clicked"),b("#logoShowStart").onWrap("click",(function(){return E()})),b("#menuTabProgram").onWrap("click","",(function(e){b("#tabSimulation").hasClass("tabClicked")&&b(".scroller-left").clickWrap(),b(".scroller-left").clickWrap(),b("#tabProgram").tabWrapShow()}),"tabProgram clicked"),b("#head-navigation-gallery").onWrap("click",(function(e){return b("#tabGalleryList").tabWrapShow(),!1}),"gallery clicked"),b("#head-navigation-tutorial").onWrap("click",(function(e){return b("#tabTutorialList").tabWrapShow(),!1}),"tutorial clicked"),b("#menuTabConfiguration").onWrap("click","",(function(e){(b("#tabProgram").hasClass("tabClicked")||b("#tabConfiguration").hasClass("tabClicked"))&&b(".scroller-right").clickWrap(),b("#tabConfiguration").clickWrap()}),"tabConfiguration clicked"),b("#menuTabNN").onWrap("click","",(function(e){(b("#tabProgram").hasClass("tabClicked")||b("#tabConfiguration").hasClass("tabClicked")||b("#tabNN").hasClass("tabClicked"))&&b(".scroller-right").clickWrap(),b("#tabNN").clickWrap()}),"tabNN clicked"),b("#menuTabNNLearn").onWrap("click","",(function(e){(b("#tabProgram").hasClass("tabClicked")||b("#tabConfiguration").hasClass("tabClicked")||b("#tabNNlearn").hasClass("tabClicked"))&&b(".scroller-right").clickWrap(),b("#tabNNlearn").clickWrap()}),"tabNNlearn clicked"),b(".navbar-fixed-top").on("mouseleave",(function(e){b(".navbar-fixed-top .dropdown").removeClass("open")})),b(".menuGeneral").onWrap("click",(function(e){window.open("https://jira.iais.fraunhofer.de/wiki/display/ORInfo")}),"head navigation menu item general clicked"),b(".menuFaq").onWrap("click",(function(e){window.open("https://jira.iais.fraunhofer.de/wiki/display/ORInfo/FAQ")}),"head navigation menu item faq clicked"),b(".shortcut").onWrap("click",(function(e){window.open("https://jira.iais.fraunhofer.de/wiki/display/ORInfo/FAQ")}),"head navigation menu item faq (shortcut) clicked"),b(".menuAboutProject").onWrap("click",(function(e){"de"==s.getLanguage()?window.open("https://www.roberta-home.de/index.php?id=135"):window.open("https://www.roberta-home.de/index.php?id=135&L=1")}),"head navigation menu item about clicked"),b(".menuLogin").onWrap("click",(function(e){l.showLoginForm()}),"head navigation menu item login clicked"),b(".menuImportProg").onWrap("click",(function(e){g.importXml()})),b("#startPopupBack").on("click",(function(e){b("#popup-robot-main").removeClass("hidden",1e3),b(".popup-robot.robotSubGroup").addClass("hidden",1e3),b(".robotSpecial").removeClass("robotSpecial"),b("#startPopupBack").addClass("hidden"),b("#popup-robot-main").slick("refresh")}));var o=0,a=0;b(".popup-robot").on("mousedown",(function(e){o=e.clientX,a=e.clientY})),b(".popup-robot").onWrap("click",(function(e){if(!(Math.abs(e.clientX-o)>=3||Math.abs(e.clientY-a)>=3)){e.preventDefault(),b("#startPopupBack").clickWrap();var n=e.target.dataset.type||e.currentTarget.dataset.type,i=e.target.dataset.group||e.currentTarget.dataset.group;if(e.target.className.indexOf("info")>=0)window.open(s.getRobots()[n].info,"_blank");else{if(n){if(i)return b("#popup-robot-main").addClass("hidden"),b(".popup-robot."+n).removeClass("hidden"),b(".popup-robot."+n).addClass("robotSpecial"),void b("#startPopupBack").removeClass("hidden");if(b("#checkbox_id").is(":checked")){w.cleanUri();var l=window.location.toString();l+=S+R+W+n,window.history.replaceState({},document.title,l),b("#show-message").oneWrap("hidden.bs.modal",(function(e){e.preventDefault(),w.cleanUri(),r.switchRobot(n,!0)})),t.displayMessage("POPUP_CREATE_BOOKMARK","POPUP","")}else r.switchRobot(n,!0)}b("#show-startup-message").modal("hide")}}}),"robot choosen in start popup"),b("#moreReleases").onWrap("click",(function(e){b("#oldReleases").show({start:function(){b("#moreReleases").addClass("hidden")}})}),"show more releases clicked"),b("#goToWiki").onWrap("click",(function(e){e.preventDefault(),window.open("https://jira.iais.fraunhofer.de/wiki/display/ORInfo","_blank"),e.stopPropagation(),b("#show-startup-message").modal("show")}),"go to wiki clicked"),b(".cancelPopup").onWrap("click",(function(){b(".ui-dialog-titlebar-close").clickWrap()}),"cancel popup clicked"),b("#about-join").onWrap("click",(function(){b("#show-about").modal("hide")}),"hide show about clicked"),b(window).on("beforeunload",(function(e){return f.Msg.POPUP_BEFOREUNLOAD})),b("#navbarCollapse").on("shown.bs.collapse",(function(){var e=Math.min(b(this).height(),Math.max(b("#blocklyDiv").height(),b("#brickly").height(),b("#nn").height()));b(this).css("height",e)})),b(document).onWrap("keydown",(function(e){if("tabProgram"==s.getView()){if((e.metaKey||e.ctrlKey)&&50==e.which){e.preventDefault();var o=s.getBlocklyWorkspace().newBlock("robActions_debug");return o.initSvg(),o.render(),o.setInTask(!1),!1}if((e.metaKey||e.ctrlKey)&&51==e.which){e.preventDefault();var a=s.getBlocklyWorkspace().newBlock("robActions_assert");a.initSvg(),a.setInTask(!1),a.render();var n=s.getBlocklyWorkspace().newBlock("logic_compare");n.initSvg(),n.setMovable(!1),n.setInTask(!1),n.setDeletable(!1),n.render();var r=a.getInput("OUT").connection,i=n.outputConnection;return r.connect(i),!1}var l;return(e.metaKey||e.ctrlKey)&&52==e.which?(e.preventDefault(),(l=s.getBlocklyWorkspace().newBlock("robActions_eval_expr")).initSvg(),l.render(),l.setInTask(!1),!1):(e.metaKey||e.ctrlKey)&&53==e.which?(e.preventDefault(),(l=s.getBlocklyWorkspace().newBlock("robActions_eval_stmt")).initSvg(),l.render(),l.setInTask(!1),!1):((e.metaKey||e.ctrlKey)&&83==e.which&&(e.preventDefault(),s.isUserLoggedIn()?"NEPOprog"===s.getProgramName()||e.shiftKey?d.showSaveAsModal():s.isProgramSaved()||d.saveToServer():t.displayMessage("ORA_PROGRAM_GET_ONE_ERROR_NOT_LOGGED_IN","POPUP","")),(e.metaKey||e.ctrlKey)&&82==e.which&&(e.preventDefault(),s.isRunEnabled()&&u.runOnBrick()),(e.metaKey||e.ctrlKey)&&77==e.which&&(e.preventDefault(),s.isUserLoggedIn()?(b("#progList").trigger("Programs"),b('.navbar-nav a[href="#progList"]').tab("show")):t.displayMessage("ORA_PROGRAM_GET_ONE_ERROR_NOT_LOGGED_IN","POPUP","")),(e.metaKey||e.ctrlKey)&&73==e.which?(e.preventDefault(),g.importXml(),!1):(e.metaKey||e.ctrlKey)&&69==e.which?(e.preventDefault(),d.exportXml(),!1):void 0)}}))}(),function e(){setTimeout((function(){(P+=1e3)>=s.getPingTime()&&s.doPing()&&(a.ping((function(e){s.setState(e)})),P=0),e()}),1e3)}(),function(){var e=new URL(document.location),o=e.protocol+"//"+e.host,t=e.hash&&e.toString().indexOf("#")<=o.length+1||!1,a=""!==e.search||!1;if(t){var n=!0,r=void 0,i=decodeURI(document.location.hash).split("&&");"#overview"===i[0]?(s.setStartWithoutPopup(),v("ev3lejosv1",(function(){d.newProgram(!0),h.start("overview")})),r=o+S+"tour"+W+"overview"):"#loadProgram"===i[0]&&i.length>=4?(s.setStartWithoutPopup(),v&&v instanceof Function&&v(i[1],g.loadProgramFromXML,[i[2],i[3]]),r=o+S+"loadProgram"+W+"_vC353v-LPr_"):"#loadSystem"===i[0]&&i.length>=2?(s.setStartWithoutPopup(),v&&v instanceof Function&&v(i[1]),r=o+S+"loadSystem"+W+i[1]):"#gallery"===i[0]?(n=!1,r=o+S+"loadSystem"+W+"<ROBOT_SYSTEM>"+y+T):"#tutorial"===i[0]&&(n=!1,r=o+S+"loadSystem"+W+"<ROBOT_SYSTEM>"+y+O,i.length>1&&(r+=W+i[1],i.length>2&&(r+=y+i[2])));var c=void 0;"de"===s.getLanguage()&&n?c="Die eingegebenen URL-Parameter sind in dieser Form veraltet und werden bald nicht mehr unterstützt.\nBitte verwende ab sofort nur noch folgende Schreibweise:\n":"en"===s.getLanguage()&&n?c="The URL parameters entered are outdated in this form and will soon no longer be supported.\nPlease use only the following spelling from now on:":"de"!==s.getLanguage()||n?"en"!==s.getLanguage()||n||(c="The URL parameters entered are outdated in this form and are no longer supported.\nPlease use only the following spelling from now on:"):c="Die eingegebenen URL-Parameter sind in dieser Form veraltet und werden nicht mehr unterstützt.\nBitte verwende ab sofort nur noch folgende Schreibweise:\n",c+=r,alert(c)}if(a){var u=x(C);u&&l.showResetPassword(u);var p=x(L);p&&l.activateAccount(p);var m=x(M);m&&(s.setStartWithoutPopup(),v("ev3lejosv1",(function(){d.newProgram(!0),h.start(m)})));var f=x(R);if(f){s.setStartWithoutPopup();var w=void 0,P=[],E=x(O),I=x(B),N=x(_),U=x(T);if(E)if("true"===E||!0===E)w=function(){b('.navbar-nav a[href="#tutorialList"]').tab("show")};else{var D=x(A);!D||!0!==D&&"true"!==D||s.setKioskMode(!0),w=function(e){k.loadFromTutorial(e)},P.push(E)}else I?(w=g.loadProgramFromXML,P.push("NEPOprog"),P.push(I)):N?w=function(){b("#menuListExamples").clickWrap()}:U&&(w=function(){b("#tabGalleryList").tabWrapShow()});v&&v instanceof Function&&v(f,w,P)}}}(),w.cleanUri()):alert("Problem")}}));
//# sourceMappingURL=menu.controller.js.map
//# sourceMappingURL=menu.controller.js.map

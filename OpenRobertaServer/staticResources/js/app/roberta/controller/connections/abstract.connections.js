var __extends=this&&this.__extends||function(){var e=function(o,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])},e(o,t)};return function(o,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();define(["require","exports","program.model","guiState.controller","guiState.controller","program.controller","robot.controller","jquery","util.roberta","message","blockly","connection.controller"],(function(e,o,t,n,a,r,s,i,d,l,c,p){Object.defineProperty(o,"__esModule",{value:!0}),o.AbstractPromptConnection=o.AbstractConnection=void 0;var u=function(){function e(){}return e.prototype.terminate=function(){i("#head-navi-icon-robot").removeClass("error"),i("#head-navi-icon-robot").removeClass("busy"),i("#head-navi-icon-robot").removeClass("wait"),n.setRunEnabled(!1),i("#runSourceCodeEditor").addClass("disabled"),i("#menuConnect").parent().addClass("disabled"),n.setPing(!1)},e.prototype.runNative=function(e){var o=this;t.runNative(n.getProgramName(),e,n.getLanguage(),(function(e){n.setState(e),o.run(e)}))},e.prototype.runOnBrick=function(e,o,a){var s=this;t.runOnBrick(n.getProgramName(),e,o,a,r.SSID,r.password,n.getLanguage(),(function(e){n.setState(e),s.run(e),r.reloadProgram(e)}))},e.prototype.stopProgram=function(){throw new Error("stop button enabled but function is not implemented/overwritten")},e.prototype.onClickMenuConnect=function(){i("#buttonCancelFirmwareUpdate").css("display","inline"),i("#buttonCancelFirmwareUpdateAndRun").css("display","none"),s.showSetTokenModal()},e.prototype.reset2DefaultFirmware=function(){var e=this;n.hasRobotDefaultFirmware()?t.resetProgram((function(o){e.run(o)})):l.displayInformation({rc:"error"},"","should not happen!")},e.prototype.onClickShowRobotInfo=function(){0!==n.getRobotName().length?i("#robotName").html(n.getRobotName()):i("#robotName").html("-"),i("#robotSystem").html(n.getRobotRealName()),"wait"===n.getRobotState()||i("#head-navi-icon-robot").hasClass("wait")?(i("#robotStateWait").css("display","inline"),i("#robotStateDisconnected").css("display","none"),i("#robotStateBusy").css("display","none")):"busy"===n.getRobotState()?(i("#robotStateWait").css("display","none"),i("#robotStateDisconnected").css("display","none"),i("#robotStateBusy").css("display","inline")):(i("#robotStateWait").css("display","none"),i("#robotStateDisconnected").css("display","inline"),i("#robotStateBusy").css("display","none")),"EN"==n.getLanguage()?i("#robotBattery").text(n.getRobotBattery()+" V"):i("#robotBattery").text(n.getRobotBattery().toString().replace(".",",")+" V");var e=parseInt(n.getRobotTime(),10);e<1e3?i("#robotWait").text(e+" ms"):i("#robotWait").text(Math.round(e/1e3)+" s"),i("#show-robot-info").modal("show")},e.prototype.onClickShowWlanForm=function(){i("#menu-wlan").modal("show")},e.prototype.updateMenuStatus=function(e){switch(e){case 0:i("#head-navi-icon-robot").removeClass("error"),i("#head-navi-icon-robot").removeClass("busy"),i("#head-navi-icon-robot").removeClass("wait"),n.setRunEnabled(!1),i("#runSourceCodeEditor").addClass("disabled"),i("#menuConnect").parent().addClass("disabled"),p.setIsAgent(!0);break;case 1:p.setIsAgent(!0),i("#head-navi-icon-robot").removeClass("error"),i("#head-navi-icon-robot").removeClass("busy"),i("#head-navi-icon-robot").addClass("wait"),n.setRunEnabled(!0),i("#runSourceCodeEditor").removeClass("disabled"),i("#menuConnect").parent().addClass("disabled");break;default:p.setIsAgent(!0),i("#menuConnect").parent().removeClass("disabled"),""==n.getRobotPort()?(i("#head-navi-icon-robot").removeClass("error"),i("#head-navi-icon-robot").removeClass("busy"),i("#head-navi-icon-robot").removeClass("wait"),n.setRunEnabled(!1)):(i("#head-navi-icon-robot").removeClass("error"),i("#head-navi-icon-robot").removeClass("busy"),i("#head-navi-icon-robot").addClass("wait"),n.setRunEnabled(!0),i("#runSourceCodeEditor").removeClass("disabled"))}},e}();o.AbstractConnection=u;var m=function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o.skipDownloadPopup=!1,o}return __extends(o,e),o.prototype.init=function(){this.clearDownloadModal(),n.setPing(!1),i("#head-navi-icon-robot").removeClass("error"),i("#head-navi-icon-robot").removeClass("busy"),i("#head-navi-icon-robot").addClass("wait"),n.setRunEnabled(!0),i("#runSourceCodeEditor").removeClass("disabled"),i("#menuConnect").parent().addClass("disabled")},o.prototype.isRobotConnected=function(){return!0},o.prototype.createDownloadLink=function(e,o){var t;if("msSaveOrOpenBlob"in navigator?(i("#trA").addClass("hidden"),d.download(e,o),n.setConnectionState("error")):i("#trA").removeClass("hidden"),"Blob"in window){var a=new Blob([o],{type:"application/octet-stream"});"msSaveOrOpenBlob"in navigator?navigator.msSaveOrOpenBlob(a,e):((t=document.createElement("a")).download=e,t.innerHTML=e,t.href=window.URL.createObjectURL(a))}else(t=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(o)),t.setAttribute("download",e),t.style.display="none";if(t&&!("msSaveOrOpenBlob"in navigator)){var r=document.createElement("div");r.setAttribute("id","programLink");var s=document.createElement("br");r.setAttribute("style","text-align: center;"),r.appendChild(s),r.appendChild(t),t.setAttribute("style","font-size:36px"),i("#downloadLink").append(r)}},o.prototype.runFileDownload=function(e,o,t){var a=(e.programName||n.getProgramName())+"."+n.getBinaryFileExtension();if("bin"!==n.getBinaryFileExtension()&&"uf2"!==n.getBinaryFileExtension()||(e.compiledCode=d.base64decode(e.compiledCode)),t||null!==navigator.userAgent.toLowerCase().match(/iPad|iPhone|android/i))d.download(a,e.compiledCode),setTimeout((function(){n.setConnectionState("wait")}),5e3),l.displayInformation(e,e.message,e.message,n.getProgramName(),n.getRobot());else{this.createDownloadLink(a,e.compiledCode);for(var r=1;c.Msg["POPUP_DOWNLOAD_STEP_"+r];r++){var s=i('<li class="typcn typcn-roberta">'),p=c.Msg["POPUP_DOWNLOAD_STEP_"+r+"_"+n.getRobotGroup().toUpperCase()]||c.Msg["POPUP_DOWNLOAD_STEP_"+r]||"POPUP_DOWNLOAD_STEP_"+r;s.html('<span class="download-message">'+p+"</span>"),s.css("opacity","0"),i("#download-instructions").append(s)}i("#download-instructions li").each((function(e){i(this).html(i(this).html().replace("$",o))})),i("#download-instructions li").each((function(e){i(this).delay(750*e).animate({opacity:1},1e3)}))}},o.prototype.setTransferProgress=function(e){i("#progressBar").width("".concat(100*e,"%")),i("#transfer").text("".concat(Math.ceil(100*e),"%"))},o.prototype.showProgressBarModal=function(){var e=i("#popupDownloadHeader").text();i("#popupDownloadHeader").text(e.replace("$",i.trim(n.getRobotRealName()))),i("#downloadType").addClass("hidden"),i("#status").removeClass("hidden"),i("#programHint").addClass("hidden"),i("#changedDownloadFolder").addClass("hidden"),i("#OKButtonModalFooter").addClass("hidden"),i("#save-client-compiled-program").modal("show")},o.prototype.setResetModalListener=function(){var e=this;i("#save-client-compiled-program").oneWrap("hidden.bs.modal",(function(o){var t=i("#popupDownloadHeader").text();i("#popupDownloadHeader").text(t.replace(i.trim(n.getRobotRealName()),"$")),i("#label-checkbox").is(":checked")&&e.setSkipDownloadPopup(!0),e.clearDownloadModal(),(0,a.setConnectionState)("wait")}))},o.prototype.setSkipDownloadPopup=function(e){this.skipDownloadPopup=e},o.prototype.clearDownloadModal=function(){i("#programLink").remove(),i("#download-instructions").empty(),i("#programHint").removeClass("hidden"),i("#changedDownloadFolder").removeClass("hidden"),i("#OKButtonModalFooter").removeClass("hidden"),i("#downloadType").addClass("hidden"),i("#status").addClass("hidden"),i("#progressBar").width("0%"),i("#transfer").text("0%"),i("#webUsb").off("click"),i("#fileDownload").off("click")},o}(u);o.AbstractPromptConnection=m}));
//# sourceMappingURL=abstract.connections.js.map
//# sourceMappingURL=abstract.connections.js.map

define(["require","exports","guiState.controller","startView.model","table","jquery","blockly","tour.controller","program.controller","import.controller","util.roberta","message","bootstrap-table"],(function(t,e,a,o,r,s,l,i,n,c,b,d){Object.defineProperty(e,"__esModule",{value:!0}),e.init=void 0;var p,u=[],g=8;function f(t){t.find("[lkey]").each((function(t){var e=s(this).attr("lkey").replace("Blockly.Msg.","");"tooltip"===s(this).attr("rel")?s(this).attr("data-bs-original-title",l.Msg[e]):s(this).html(l.Msg[e])}))}e.init=function(t){p=t;var e=s.Deferred(),h=a.getRobots(),m=(u=Object.keys(h).map((function(t){var e=h[t];return e.startSelection=[],e}))).findIndex((function(t,e){return"calliope2017NoBlue"===t.name})),T=u.findIndex((function(t,e){return"calliope2017"===t.name}));m>-1&&T>-1&&(u[m].startSelection.push("blue"),u.splice(T,1)),u.forEach((function(t,e){t.rowNum=e}));var v=function(t){return new Promise((function(e,a){var o=new Image;o.onload=function(){e(o)},o.onerror=function(){console.error("could not preload "+t),e(null)},o.src=t}))},R=u.map((function(t){return"/css/img/system_preview/"+t.name+".jpg"}));return s.when(function(t){return Promise.all(t.map(v))}(R)).then((function(t){var h,m,T,v;!function(){var t=a.getLanguage(),e=u.slice(0,g);function o(t,e,a,o){t.stopPropagation();var r=[];s(t.target).closest(".card-views").find(".form-check-input").each((function(){if(s(this).prop("checked")){var t=s(this).val().toString();r.push(t)}}));var l,i=a.name;(-1!==r.indexOf("blue")&&"calliope2017NoBlue"===a.name&&(i="calliope2017"),p(i),b.cleanUri(),o)&&(s(window).oneWrap("hashchange",(function(){window.history.replaceState({},document.title,l)})),l=window.location.toString(),l+="?loadSystem="+i,window.history.replaceState({},document.title,l),s("#show-message").oneWrap("hidden.bs.modal",(function(t){t.preventDefault(),b.cleanUri()})),d.displayMessage("POPUP_CREATE_BOOKMARK","POPUP",""));return!1}function i(t,e,a){o(t,e,a,!0)}var n={columns:[{field:"rowNum",sortable:!0,visible:!1,searchable:!1},{field:"announcement",title:"",searchable:!1,formatter:function(t,e,a){var o='<a href="#" class="pick typcn typcn-star-outline bookmark" rel="tooltip" data-bs-placement="top" data-bs-original-title="'+l.Msg.START_BOOKMARK_TOOLTIP+'" aria-label="'+l.Msg.START_BOOKMARK_TOOLTIP+'"  lkey="Blockly.Msg.START_BOOKMARK_TOOLTIP" title=""></a>';return t&&"beta"===t?o+"<img class='img-beta' src='/css/img/beta.png' alt='beta' />":t&&"deprecated"===t?o+"<img class='img-deprecated' src='/css/img/deprecated.png' alt='deprecated' />":o},events:{"click .pick":i}},{field:"group",sortable:!0,searchable:!0,visible:!1},{field:"name",title:"",sortable:!0,searchable:!1,formatter:r.CardView.robotImage,events:{"click .robotImage":function(t,e,a){o(t,e,a,!1)}}},{field:"nn",visible:!1,sortable:!0,searchable:!1},{field:"progLanguage",visible:!1,sortable:!0,searchable:!1},{field:"realName",title:"",sortable:!0,searchable:!0,searchFormatter:!1,searchAccentNeutralise:!0,formatter:function(t){return'<div class="robotName">'+t+"</div>"}},{field:"sim",visible:!1,sortable:!0,searchable:!1},{title:"",field:"startSelection",searchable:!1,formatter:function(t,e){var a=s("#startSelectionTemplate").html(),o=s(a);return o.addClass("invisible"),t.forEach((function(t){o.removeClass("invisible"),o.find("#"+t).parent().removeClass("hidden")})),o[0].outerHTML}},{title:"",field:"startNow",searchable:!1,formatter:function(){return'<button href="#" lkey="Blockly.Msg.START_START" class="btn start pick typcn typcn-arrow-right" role="button">'+l.Msg.START_START+"</button>"},events:{"click .pick":function(t,e,a){o(t,e,a,!1)}}}],locale:t,toolbar:"#robotListToolbar",cardView:"true",search:!0,rowStyle:{classes:"col-xxl-3 col-sm-6 col-xs-12"},showRefresh:!1,buttons:function(){return{popularRobots:{html:'<button class="nav-link active start" data-bs-toggle="button" autocomplete="off" aria-pressed="true" data-bs-original-title="" id="popularRobots" lkey="Blockly.Msg.START_POPULAR_ROBOTS">'+l.Msg.START_POPULAR_ROBOTS+"</button>"},allRobots:{html:'<button class="nav-link start" data-bs-toggle="button" autocomplete="off" aria-pressed="false" data-bs-original-title="" id="allRobots" lkey="Blockly.Msg.START_ALL_ROBOTS">'+l.Msg.START_ALL_ROBOTS+'</button><span id="results"></span>&nbsp;<span id="labelResults" lkey="Blockly.Msg.START_RESULTS">'+l.Msg.START_RESULTS+"</span>"}}},buttonsAlign:"left",filterControlContainer:!0};s("#robotTable").bootstrapTable(n),s("#robotTable").bootstrapTable("load",e),s(".bookmark").tooltip({trigger:"hover"}),s("#start input.form-control.search-input").attr("placeholder",l.Msg.START_FORMATSEARCH),f(s("#robotTable")),s("#start .fixed-table-toolbar>.float-right").toggleClass("hidden"),s("span#results").text(e.length)}(),h=s("#startFeatureTemplate").html(),m=s("#startProgrammingLanguageTemplate").html(),T=s(h),v=s(m),f(T),f(v),s("#start .fixed-table-toolbar").append(T),s("#start .fixed-table-toolbar .btn-group:last-child").prepend(v),function(){s("#tabStart").onWrap("show.bs.tab",(function(t){s("#tabProgram, #tabConfiguration").parent().addClass("invisible"),s("#tabNN, #tabNNLearn").parent().hide(),s(".notStart").addClass("disabled"),s("#header").removeClass("shadow"),a.resetRobot(),a.setView("tabStart")}));var t=function(){if(!s("#allRobots").hasClass("active"))return s(this).addClass("active"),!1;s("#more").toggleClass("more"),s("#more").attr("lkey","Blockly.Msg.START_ALL_ROBOTS"),s("#more").text(l.Msg.START_ALL_ROBOTS),s("#start .fixed-table-toolbar>.float-right").toggleClass("hidden"),s("#allRobots").toggleClass("active"),s("#allRobots").attr("aria-pressed","false");var t=u.slice(0,g);s("#robotTable").bootstrapTable("load",t),s("#robotTable").bootstrapTable("resetSearch",""),s("#robotTable").bootstrapTable("sortBy",{field:"rowNum",sortOrder:"asc"}),s("#robotTable").bootstrapTable("filterBy",[]),s("#start").animate({scrollTop:s(".section--white").height()},500)};s("#popularRobots").onWrap("click",t);var e=function(){if(!s("#popularRobots").hasClass("active"))return s(this).addClass("active"),!1;s("input.progLang, input.feature").each((function(){s(this).prop("checked",!1)})),s("#more").toggleClass("more"),s("#more").attr("lkey","Blockly.Msg.START_POPULAR_ROBOTS"),s("#more").text(l.Msg.START_POPULAR_ROBOTS),s("#start .fixed-table-toolbar>.float-right").toggleClass("hidden"),s("#popularRobots").toggleClass("active"),s("#popularRobots").attr("aria-pressed","false"),s("#robotTable").bootstrapTable("load",u),s("#robotTable").bootstrapTable("filterBy",[]),s("#robotTable").bootstrapTable("sortBy",{field:"realName",sortOrder:"asc"}),s("#start").animate({scrollTop:s(".section--white").height()},500),s("#start input.form-control.search-input").trigger("focus")};s("#allRobots").onWrap("click",e),s("#more").onWrap("click",(function(){s(this).hasClass("more")?(s("#allRobots").trigger("click"),e()):(s("#popularRobots").trigger("click"),t())})),s("#robotTable").on("post-body.bs.table",(function(t,e){s("span#results").text(e.length),s(".bookmark").tooltip({trigger:"hover"})})),s("#start .btn-group input").onWrap("change",(function(t){var e={};s("input.progLang").each((function(){s(this).prop("checked")&&(e.progLanguage||(e.progLanguage=[]),e.progLanguage.push(s(this).val().toString()))})),s("input.feature").each((function(){s(this).prop("checked")&&(e[s(this).val().toString()]=!0)})),s("#robotTable").bootstrapTable("filterBy",e)})),s("#startImportProg").onWrap("click",(function(t){t.stopPropagation(),c.importXmlFromStart(p)}),"import clicked"),s("#takeATour").onWrap("click",(function(t){t.stopPropagation(),p("ev3lejosv1",(function(){n.newProgram(!0),i.start("welcome")}))}),"take a tour clicked")}(),function(){var t=function(){},e=function(t){s('<section class="section--white" id="section--news"><div class="container-fluid"><div class="row justify-content-center"><div class="col col-12 col-xl-10 col-xxl-8 col-xxxl-6 my-4"><div class="teaser-news"><div class="row justify-content-between align-items-center"><div class="col col-12 col-md-6"><div class="teaser-news--header">Neues aus dem Open Roberta Lab</div><div class="teaser-news--body" id="teaser-news--rss"></div></div><div class="col col-12 col-md-6 col-lg-4 offset-md-0 offset-lg-2 mt-5 mt-md-0" id="teaser-news--rss-image"></div></div></div></div></div></div></section>').insertBefore("footer"),s(t).find("item").each((function(){var t=s('<div class="teaser-news--body"></div>'),e=s(this).find("title").text(),a=s(this).find("description").text(),o=s(this).find("link").text(),r=s(this).find("enclosure").attr("url");t.append('<div><img src="'+r+'" /></div>'),s("#teaser-news--rss").append("<h3>"+e+"</h3>").append('<p class="teaser">'+a+"</p>").append('<a target="_blank" class="teaser-news--link button button--light" href="'+o+'">Mehr erfahren</a>'),s("#teaser-news--rss-image").append('<img class="teaser-news--image" src="'+r+'">')}))};if("de"!==a.getLanguage())return t();o.fetchRSS(e,t)}(),e.resolve()})),e.promise()}}));
//# sourceMappingURL=startView.controller.js.map
//# sourceMappingURL=startView.controller.js.map

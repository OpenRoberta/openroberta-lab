define(["require","exports","message","log","guiState.controller","program.controller","robot.controller","import.controller","blockly","util.roberta","jquery","bootstrap"],(function(t,e,i,a,n,o,s,r,l,p,u,c){Object.defineProperty(e,"__esModule",{value:!0}),e.loadFromTutorial=e.init=void 0;var d,v,h,b=.5,m=0,f=0,g=[],k=[],z=!1;function q(t){v=t,(h=d&&d[t])&&s.switchRobot(h.robot,{},!1,(function(){u("#tabProgram").tabWrapShow(),n.isKioskMode()&&(u("#infoButton").hide(),u("#feedbackButton").hide(),0===h.level.indexOf("1")&&u("#codeButton").hide(),p.removeLinks(u("#legalDiv a")));h.initXML&&r.loadProgramFromXML("egal",h.initXML);f=h.step.length,m=0,g=[],k=[],z=!1;for(var t=0;t<h.step.length;t++)if(h.step[t].quiz){z=!0;break}u("#tutorialHeader").empty();for(t=0;t<h.step.length;t++)u("#tutorialHeader").append(u("<li>").attr("class","step").append(u("<a>").attr({href:"#"}).append(t+1)));u("#tutorialHeader li:last-child").addClass("last"),u("#tutorial-header").html(h.name),u("#tutorial-navigation, #tutorialEnd, #tutorialButton").show(),u("#head-navigation, #tab-navigation").hide(),u("#tutorialHeader :first-child").addClass("active"),u(".blocklyToolboxDiv>.levelTabs").addClass("invisible"),u("#tutorialHeader.nav li.step a").on("click",(function(){m=u(this).text()-2,w(),A()})),u("#tutorialEnd").oneWrap("click",(function(t){return B(),!1})),y(),A(),function(){if(!h.overview)return;var t=h.overview.description;if(t+="</br></br><b>Lernziel: </b>",t+=h.overview.goal,t+="</br></br><b>Vorkenntnisse: </b>",t+=h.overview.previous,t+='<hr style="border: 2px solid #33B8CA; margin: 10px 0">',t+='<span class="typcn typcn-stopwatch"/>&emsp;&emsp;',t+=h.time,t+='</br><span class="typcn typcn-group"/>&emsp;&emsp;',t+=h.age,t+='</br><span class="typcn typcn-simulation"/>&emsp;&emsp;',t+=!h.sim||"sim"!==h.sim&&1!==h.sim?"nein":"ja",h.level){t+='</br><span class="typcn typcn-mortar-board"/>&emsp;&emsp;';for(var e=isNaN(h.level)?h.level.split("/")[1]:3,i=isNaN(h.level)?h.level.split("/")[0]:h.level,o=1;o<=e;o++)t+=o<=i?'<span class="typcn typcn-star-full-outline"/>':'<span class="typcn typcn-star-outline"/>'}t+='</br><span class="typcn typcn-roberta"/>&emsp;&emsp;',t+=n.getMenuRobotRealName(h.robot),u("#tutorialOverviewText").html(t),u("#tutorialOverviewTitle").html(h.name),n.isKioskMode()&&p.removeLinks(u("#tutorialOverview a"));u("#tutorialAbort").off("click.dismiss.bs.modal"),u("#tutorialAbort").onWrap("click.dismiss.bs.modal",(function(t){B()}),"tutorial exit"),u("#tutorialContinue").off("click.dismiss.bs.modal"),u("#tutorialContinue").onWrap("click.dismiss.bs.modal",(function(t){a.info("tutorial executed "+h.index+v)}),"tuorial continue"),new c.Modal(document.getElementById("tutorialOverview"),{backdrop:"static",keyboard:!1}).show()}()}))}function y(){if(h.step[m]){if(u("#tutorialContent").empty(),h.step[m].instruction){if(h.step[m].toolbox)try{n.setDynamicProgramToolbox(h.step[m].toolbox),o.loadExternalToolbox(h.step[m].toolbox),l.mainWorkspace.options.maxBlocks=h.step[m].maxBlocks}catch(t){console.log(t)}if(h.step[m].header&&u("#tutorialContent").append(u("<h3>").attr("class","quiz header").append(h.step[m].header)),u("#tutorialContent").append(h.step[m].instruction),h.step[m].tip)if(u("#tutorialContent").append("<br><br>").append(u("<ul>").attr("class","tip")),Array.isArray(h.step[m].tip))for(var t=0;t<h.step[m].tip.length;t++)u("#tutorialContent ul.tip").append("<li>"+h.step[m].tip[t]+"</li>");else u("#tutorialContent ul.tip").append("<li>"+h.step[m].tip+"</li>");h.step[m].solution&&u("#tutorialContent").append(u("<div>").attr("id","helpDiv").append(u("<button>",{text:"Hilfe",id:"quizHelp",class:"btn test",click:function(){u("#helpDiv").append(u("<div>").append(h.step[m].solution).attr({class:"imgSol"})),u("#quizHelp").remove()}}))),m==f-1?u("#tutorialContent").append(u("<div>").attr("class","quiz continue").append(u("<button>",{text:"Tutorial beenden",class:"btn",click:function(){return i.displayMessage(h.end,"POPUP",""),u("#show-message").oneWrap("hide.bs.modal",(function(t){return B(),!1})),!1}}))):u("#tutorialContent").append(u("<div>").attr("class","quiz continue").append(u("<button>",{text:"weiter",class:"btn",click:function(){C()}})))}else C();n.isKioskMode()&&p.removeLinks(u("#tutorialContent a"))}}function C(){h.step[m].quiz?(u("#tutorialContent").html(""),u("#tutorialContent").append(u("<div>").attr("class","quiz content")),h.step[m].quiz.forEach((function(t,e){u("#tutorialContent .quiz.content").append(u("<div>").attr("class","quiz question").append(t.question));!function(t){for(var e,i,a=t.length;a;e=Math.floor(Math.random()*a),i=t[--a],t[a]=t[e],t[e]=i);}(t.answer);t.answer.forEach((function(t,i){var a="!"!==t.charAt(0);a||(t=t.substr(1)),u("#tutorialContent .quiz.content").append(u("<label>").attr("class","quiz answer").append(t).append(u("<input>",{type:"checkbox",class:"quiz",name:"answer_"+i,id:e+"_"+i,value:a})).append(u("<span>",{for:e+"_"+i,class:"checkmark quiz"})))}))})),u("#tutorialContent .quiz.content").append(u("<div>").attr("class","quiz footer").attr("id","quizFooter").append(u("<button/>",{text:"prüfen!",class:"btn test left",click:function(){!function(){var t=0,e=0,i=u(".quiz.question").length,a=u(".quiz.answer [value=true]").length;if(u(".quiz input").each((function(i,a){var n=u('label>span[for="'+u(this).attr("id")+'"]');u(this).is(":checked")&&e++,"true"===u(this).val()&&u(this).is(":checked")&&(n.parent().addClass("correct"),t++),"false"===u(this).val()&&u(this).is(":checked")&&n.parent().addClass("fail"),u(this).attr("onclick","return false;")})),u("#quizFooter").html(""),t!==a){var n;u("#quizFooter").append(u("<button/>",{text:"nochmal",class:"btn test",click:function(){C()}})),n=0==e?"Bitte kreuze mindestens eine Anwort an.":1==i?"Die Antwort ist leider nicht ganz richtig.":t+" Anworten von "+a+" sind richtig!",u("#quizFooter").append(u("<span>",{text:n}))}u("#tutorialContent").append(u("<div>").attr("class","quiz continue").append(u("<button>",{text:"weiter",class:"btn",click:function(){w()}}))),g[m]=t,k[m]=a}()}})))):w()}function w(){if((m+=1)<f&&(u("#tutorialHeader .active").removeClass("active"),u("#tutorialHeader .preActive").removeClass("preActive"),u("#tutorialHeader .step a:contains('"+(m+1)+"')").parent().addClass("active"),u("#tutorialHeader .step a:contains('"+m+"')").parent().addClass("preActive"),y(),m==f-1&&z)){for(var t=0,e=k.length;e--;)k[e]&&(t+=k[e]);var i=0;for(e=g.length;e--;)g[e]&&(i+=g[e]);var a=0;0!==t&&(a=Math.round(100/t*i));Math.round((a-50)/17);u("<div>").attr("class","quiz footer").attr("id","quizFooter").append(i+" von "+t+" Antworten oder "+a+"% sind richtig! ").insertBefore(u(".quiz.continue")),u("#quizFooter").append(u("<span>",{id:"quizResult"})),a>0&&u("#quizResult").append(u("<span>",{class:"typcn typcn-thumbs-up"})),100==a?(u("#quizResult").append(u("<span>",{class:"typcn typcn-thumbs-up"})),u("#quizResult").append(u("<span>",{class:"typcn typcn-thumbs-up"})),u("#quizResult").append(" Spitze!")):a>80?(u("#quizResult").append(u("<span>",{class:"typcn typcn-thumbs-up"})),u("#quizResult").append(" Super!")):a>60?u("#quizResult").append(" Gut gemacht!"):0==a?u("#quizResult").append(" Du kannst die Quizfragen jederzeit wiederholen, wenn du möchtest!"):u("#quizResult").append(" Das ist ok!")}}function x(t){u("#tutorialButton").hasClass("rightActive")?u("#blocklyDiv").closeRightView():t.openRightView(u("#tutorialDiv"),b)}function A(){if(!u("#tutorialDiv").hasClass("rightActive"))if(u("#blocklyDiv").hasClass("rightActive")){!function t(){u("#blocklyDiv").hasClass("rightActive")?setTimeout(t,50):x()}()}else x(u("#tutorialButton"))}function B(){u("#tutorial-navigation, #tutorialEnd, #tutorialButton").hide(),u("#head-navigation, #tab-navigation").show(),u(".blocklyToolboxDiv>.levelTabs").removeClass("invisible"),n.resetDynamicProgramToolbox(),o.loadExternalToolbox(n.getProgramToolbox()),l.mainWorkspace.options.maxBlocks=void 0,n.isKioskMode()?(u(".modal").modal("hide"),q(v)):(u(".rightMenuButton.rightActive").length>=0&&u(".rightMenuButton.rightActive").clickWrap(),u("#tabTutorialList").tabWrapShow())}e.init=function(){d=n.getListOfTutorials(),n.getBlocklyWorkspace(),u(".menu.tutorial").onWrap("click",(function(t){startTutorial(t.target.id)})),u("#tutorialButton").onWrap("click touchend",(function(){return x(u(this)),!1}))},e.loadFromTutorial=q}));
//# sourceMappingURL=progTutorial.controller.js.map
//# sourceMappingURL=progTutorial.controller.js.map

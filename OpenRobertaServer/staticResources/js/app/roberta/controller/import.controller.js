define(["require","exports","message","log","util.roberta","guiState.controller","program.controller","nn.controller","configuration.controller","program.model","blockly","jquery","jquery-validate"],(function(e,o,r,t,a,i,n,l,c,m,p,g){function f(e,o){g("#fileSelector").val(null),g("#fileSelector").off(),g("#fileSelector").onWrap("change",(function(r){var t=r.target.files[0],i=new FileReader;return i.onload=function(r){var i=a.getBasename(t.name);e&&"function"==typeof e&&e(i,r.target.result,o)},i.readAsText(t),!1}),"import clicked")}function s(e,o,t){var n=o.indexOf('robottype="');n+=11;var l,c=o.indexOf('"',n),m=o.substring(n,c);m.indexOf("calliope")>=0&&(l="calliope2017NoBlue");for(var g=0,f=Object.entries(i.getRobots());g<f.length;g++){var s=f[g],d=(s[0],s[1]);d.name===m&&(l=d.group)}l?t&&"function"==typeof t&&t(l,{},u,[e,o]):r.displayInformation({rx:"error"},"",p.Msg.PROGRAM_IMPORT_ERROR_MISSING_ROBOT_TYPE,a.getRobotGroupsPrettyPrint(m))}function u(e,o){-1===o.search("<export")&&(o='<export xmlns="http://de.fhg.iais.roberta.blockly"><program>'+o+"</program><config>"+i.getConfigurationXML()+"</config></export>"),m.loadProgramFromXML(e,o,(function(o){if("ok"==o.rc){l.programWasReplaced();var a=p.Xml.workspaceToDom(i.getBlocklyWorkspace()),m=p.Xml.domToText(a);i.setProgramXML(m),a=p.Xml.workspaceToDom(i.getBricklyWorkspace());var g=p.Xml.domToText(a);i.setConfigurationXML(g),o.programSaved=!1,o.name="NEPOprog",o.programShared=!1,o.programTimestamp="";var f=i.getConfigurationName();try{c.configurationToBricklyWorkspace(o.confXML),i.setConfigurationXML(o.confXML),n.programToBlocklyWorkspace(o.progXML),i.setProgram(o),i.setProgramXML(o.progXML),i.setConfigurationName(""),t.info("show program "+i.getProgramName())}catch(a){t.error(a.message),i.setProgramXML(m),i.setConfigurationXML(g),i.setConfigurationName(f),c.reloadConf(),n.reloadProgram(),o.rc="error",r.displayInformation(o,"",p.Msg.ORA_PROGRAM_IMPORT_ERROR,e)}}else"ORA_PROGRAM_IMPORT_ERROR_WRONG_ROBOT_TYPE"===o.message?r.displayInformation(o,"",o.message,o.robotTypes):r.displayInformation(o,"",o.message,e)}))}function d(e,o){m.compileN(e,o,i.getLanguage(),(function(e){var o=e.rc;void 0!==e.parameters&&(o+="\nMessage is:\n"+e.parameters.MESSAGE),alert(o)}))}function M(e,o){m.compileP(e,o,i.getLanguage(),(function(e){alert(e.rc)}))}Object.defineProperty(o,"__esModule",{value:!0}),o.importNepoCodeToCompile=o.importSourceCodeToCompile=o.loadProgramFromXML=o.importSourceCode=o.importXmlFromStart=o.importXml=o.init=void 0,o.init=f,o.importXml=function(){f(u),g("#fileSelector").attr("accept",".xml"),g("#fileSelector").clickWrap(),g(".rightMenuButton.rightActive").length>0&&g(".rightMenuButton.rightActive").clickWrap()},o.importXmlFromStart=function(e){f(s,e),g("#fileSelector").attr("accept",".xml"),g("#fileSelector").clickWrap()},o.importSourceCode=function(e){f(e),g("#fileSelector").attr("accept","."+i.getSourceCodeFileExtension()),g("#fileSelector").clickWrap()},o.loadProgramFromXML=u,o.importSourceCodeToCompile=function(){f(d),g("#fileSelector").attr("accept","."+i.getSourceCodeFileExtension()),g("#fileSelector").clickWrap()},o.importNepoCodeToCompile=function(){f(M),g("#fileSelector").attr("accept",".xml"),g("#fileSelector").clickWrap()}}));
//# sourceMappingURL=import.controller.js.map
//# sourceMappingURL=import.controller.js.map

define(["require","exports","microbitConstants"],(function(r,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.onlyChanged=e.pageAlignBlocks=e.Page=e.regRequest=e.apReg=e.murmur3_core=e.bufferConcat=e.read32FromUInt8Array=e.CoreRegister=void 0,e.CoreRegister={SP:13,LR:14,PC:15};e.read32FromUInt8Array=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0};e.bufferConcat=function(r){for(var e=0,t=0,n=r;t<n.length;t++){e+=(i=n[t]).length}var a=new Uint8Array(e);e=0;for(var o=0,u=r;o<u.length;o++){var i=u[o];a.set(i,e),e+=i.length}return a};e.murmur3_core=function(r){for(var t=798746316,n=516138696,a=0;a<r.byteLength;a+=4){var o=(0,e.read32FromUInt8Array)(r,a)>>>0;o=(o=Math.imul(o,3432918353))<<15|o>>>17,t=(t^=o=Math.imul(o,461845907))<<13|t>>>19,n=(n^=o)<<13|n>>>19,t=Math.imul(t,5)+3864292196>>>0,n=Math.imul(n,5)+3864292196>>>0}return[t,n]};e.apReg=function(r,e){return 4+((12&(r|e|t.DapVal.AP_ACC))>>2)};e.regRequest=function(r,e){void 0===e&&(e=!1);var t=e?0:2;return t|=r<4?0:1,t|=(3&r)<<2};var n=function(r,e){this.targetAddr=r,this.data=e};e.Page=n;e.pageAlignBlocks=function(r,e,t){for(var a=new Uint8Array(r),o=[],u=0;u<a.byteLength;){for(var i=new Uint8Array(t).fill(255),f=e+u-(e+u&t-1);u<a.byteLength&&!(e+u>=f+t);++u)i[e+u-f]=a[u];var g=new n(f,i);o.push(g)}return o};e.onlyChanged=function(r,t,n){return r.filter((function(r){var a=r.targetAddr/n;if(8*a+8>t.length)return!0;var o=(0,e.read32FromUInt8Array)(t,8*a),u=(0,e.read32FromUInt8Array)(t,8*a+4),i=(0,e.murmur3_core)(r.data);return o!==i[0]||u!==i[1]}))}}));
//# sourceMappingURL=partialFlashingUtils.js.map
//# sourceMappingURL=partialFlashingUtils.js.map
